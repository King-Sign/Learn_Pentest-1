# Directory traversal
* [Directory traversal là gì ?](#khainiem)
* [Lab: File path traversal, simple case ](#lab1)
* [Lab: File path traversal, traversal sequences blocked with absolute path bypass](#lab2)
* [Lab: File path traversal, traversal sequences stripped non-recursively](#lab3)
* [Lab: File path traversal, traversal sequences stripped with superfluous URL-decode](#lab4)
* [Lab: File path traversal, validation of start of path](#lab5)
* [Lab: File path traversal, validation of file extension with null byte bypass](#lab6)
* [Một số web hướng dẫn](#lab7)
# Directory traversal là gì ? <a name="khainiem">
  >Là một lỗ hổng cho phép mình đọc các file trên máy chủ,một số trường hợp mình có thể ghi đè lên những file có sẵn.
  
  >Linux: dùng dấu /<br>
  ![image](https://user-images.githubusercontent.com/20487674/122179819-0ea30f80-ceb2-11eb-986b-d7286ced1826.png)

  >Windows: dùng dấu / và \\<br>
  ![image](https://user-images.githubusercontent.com/20487674/122188346-1070d100-ceba-11eb-8a26-1752f6cea742.png)

# Lab: File path traversal, simple case <a name="lab1">
  Ta sẽ thực hiện fuzzing parameter filename
  ![image](https://user-images.githubusercontent.com/20487674/122180502-af91ca80-ceb2-11eb-8670-afd67b77ad8c.png)<br>
  Tiếp tục thử di chuyển đến /etc/passwd bằng  ../etc/passwd
  ![image](https://user-images.githubusercontent.com/20487674/122180875-08f9f980-ceb3-11eb-9c42-2b3b4b1d1a56.png)<br>
  Tiếp tục di chuyển  đến file passwd ../../../etc/passwd và hoàn thành bài lab
  ![image](https://user-images.githubusercontent.com/20487674/146149497-4c7ec9e9-d6ed-44e4-bf07-d3a635547033.png)

# Lab: File path traversal, traversal sequences blocked with absolute path bypass <a name="lab2">
   Lab này sẽ block khi đọc file passwd bằng cách di chuyển 
   Ta sẽ tiếp thực hiện fuzzing parameter filename
  ![image](https://user-images.githubusercontent.com/20487674/122182033-1794e080-ceb4-11eb-870f-77de89c44213.png)
  ![image](https://user-images.githubusercontent.com/20487674/122182091-267b9300-ceb4-11eb-9827-fb6ec4b48115.png)<br>
  Nên ta sẽ dụng path default: /etc/passwd và hoàn thành bài lab
  ![image](https://user-images.githubusercontent.com/20487674/122182584-99850980-ceb4-11eb-82fa-3fdded93120a.png)
# Lab: File path traversal, traversal sequences stripped non-recursively <a name="lab3">
  Lab sẽ thực hiện cắt chuỗi nếu như ta đọc file passwd bằng các di chuyển <br>
  Input: ../../../etc/passwd<br>
  Output: etc/passwd<br>
  Ta sẽ thực hiện chèn ../ lồng vào nhau ....//<br>
  Input: ....//....//....//etc/passwd<br>
  Output: ../../../etc/passwd<br>
  ![image](https://user-images.githubusercontent.com/20487674/122183794-c8e84600-ceb5-11eb-9641-c8c4183597ec.png)
# Lab: File path traversal, traversal sequences stripped with superfluous URL-decode <a name="lab4">
  Lab này sẽ block nếu như ta đọc file passwd bằng các di chuyển ../ .Nó sẽ thực hiện url-decode trước và sau đó sẽ kiểm tra chuỗi nếu như ta đọc file passwd bằng các di chuyển ../ sẽ bị block.
  Dấu / => %2f => %252f
  ![image](https://user-images.githubusercontent.com/20487674/122185685-7d369c00-ceb7-11eb-9e47-cf90b54dfec4.png)<br>
  Thực hiện double encode url:
  ![image](https://user-images.githubusercontent.com/20487674/122185950-bbcc5680-ceb7-11eb-860b-b4c6891c70aa.png)
# Lab: File path traversal, validation of start of path <a name="lab5">
  lab này muốn chúng ta đọc file passwd nhưng phải bắt đầu bằng path cho trước
  Bắt đầu ta thấy parameter filename chứa /var/www/images/6.jpg
  ![image](https://user-images.githubusercontent.com/20487674/122189669-4febed00-cebb-11eb-825f-9e11dd247212.png)<br>
  Bypass qua bằng cách  /var/www/images/../../../etc/passwd.Giải thích 1 tý tại sao lại dùng payload như vậy
  ![Capture](https://user-images.githubusercontent.com/20487674/122192634-08b32b80-cebe-11eb-9e88-3254e80fad50.PNG)<br>
  Như vậy tương tự payload /var/www/images/../../../etc/passwd cũng hoạt động tương tự vậy
  ![image](https://user-images.githubusercontent.com/20487674/122192929-487a1300-cebe-11eb-86d4-6e65c172f2dc.png)
# Lab: File path traversal, validation of file extension with null byte bypass <a name="lab6">
  lab này muốn chúng ta đọc nhập chuỗi đầu và chuỗi đó phải kết thúc bằng các đuôi file,để bypass sử dụng ký tự null,thì null byte chỉ có tác dụng  magic_quotes_gpc=Off hoặc với php version < 5.3.4 
  Vì PHP sử dụng các hàm C để xử lý , do đó việc xử lý các chuỗi mà có null byte nó sẽ đc hiểu rằng những ký tự sau null byte sẽ được loại bỏ và các ký tự đó coi như không có trong chuỗi.Nguồn [Null byte injection in PHP](https://resources.infosecinstitute.com/topic/null-byte-injection-php/)
  * ![image](https://user-images.githubusercontent.com/20487674/122195134-4618b880-cec0-11eb-8086-4bf9d748937a.png)
# Một số web hướng dẫn <a name="lab7">
  [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Directory%20Traversal](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Directory%20Traversal)<br>
  [https://book.hacktricks.xyz/pentesting-web/file-inclusion](https://book.hacktricks.xyz/pentesting-web/file-inclusion)
  
  
  
  
  


  
  
  




  

  

  
