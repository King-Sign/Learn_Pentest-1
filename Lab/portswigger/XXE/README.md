# XML external entity (XXE) injection
* [XXE là gì ?](#khainiem)
* [Các loại XXE ](#loai)
* [Lab portswigger ](#lab)
* [Link kham khảo](#link)
# XXE là gì <a name="khainiem"> 
  > XML external entity Là một lỗ hổng cho phép kẻ tấn công chèn những đoạn xml và entity và element tùy có thể khiến kẻ tấn công can thiệp vào server việc xử lý đoạn xml, tác động có thể đọc được dữ liệu các file trên hệ thống và kiểm soát được request của server dẫn đến công SSRF , và có thực hiện được RCE nến backend được viết bằng php có lợi dụng các PHP wrapper trong có expect://commandline cho phép thực hiện cái commandline đó.
# Các loại XXE <a name="loai">
  > Có 2 loại 
  ## Basic SSRF
  * Khi mà kẻ tấn công request kèm những đoạn xml đến serever nạn nhân và server nhận sẽ thực thi request đó và sau khi phản hồi thường đi kèm dữ liệu trả về đến kẻ tấn công.
  ## Blind SSRF
  * Khi mà kẻ tấn công request kèm những đoạn xml đến serever nạn nhân và server nhận sẽ thực thi request đó và sau khi phản hồi lại không đi kèm dữ liệu trả về đến kẻ tấn công.
# Lab portswigger <a name="lab">
  * [Lab: Exploiting XXE using external entities to retrieve files](https://github.com/truonghuuphuc/Learn_Pentest/blob/main/Lab/portswigger/XXE/Exploiting%20XXE%20using%20external%20entities%20to%20retrieve%20files.md)
  * [Lab: Exploiting XXE to perform SSRF attacks](https://github.com/truonghuuphuc/Learn_Pentest/blob/main/Lab/portswigger/XXE/Exploiting%20XXE%20to%20perform%20SSRF%20attacks.md)
  * [Lab: Exploiting XInclude to retrieve files](https://github.com/truonghuuphuc/Learn_Pentest/blob/main/Lab/portswigger/XXE/Exploiting%20XInclude%20to%20retrieve%20files.md)
  * [Lab: Exploiting XXE via image file upload](https://github.com/truonghuuphuc/Learn_Pentest/blob/main/Lab/portswigger/XXE/Exploiting%20XXE%20via%20image%20file%20upload.md)
  * [Lab: Blind XXE with out-of-band interaction](https://github.com/truonghuuphuc/Learn_Pentest/blob/main/Lab/portswigger/XXE/Blind%20XXE%20with%20out-of-band%20interaction.md)
  * [Lab: Blind XXE with out-of-band interaction via XML parameter entities](https://github.com/truonghuuphuc/Learn_Pentest/blob/main/Lab/portswigger/XXE/Blind%20XXE%20with%20out-of-band%20interaction%20via%20XML%20parameter%20entities.md)
  * [Lab: Exploiting blind XXE to exfiltrate data using a malicious external DTD](https://github.com/truonghuuphuc/Learn_Pentest/blob/main/Lab/portswigger/XXE/Exploiting%20blind%20XXE%20to%20exfiltrate%20data%20using%20a%20malicious%20external%20DTD.md)
  * [Lab: Exploiting blind XXE to retrieve data via error messages](https://github.com/truonghuuphuc/Learn_Pentest/blob/main/Lab/portswigger/XXE/Exploiting%20blind%20XXE%20to%20retrieve%20data%20via%20error%20messages.md)
  * [Lab: Exploiting XXE to retrieve data by repurposing a local DTD](https://github.com/truonghuuphuc/Learn_Pentest/blob/main/Lab/portswigger/XXE/Exploiting%20XXE%20to%20retrieve%20data%20by%20repurposing%20a%20local%20DTD.md)
# Link kham khảo <a name="link">
 * https://portswigger.net/web-security/xxe/xml-entities
 * https://www.w3resource.com/xml/parameter-entities.php
 * https://www.tutorialspoint.com/dtd/dtd_entities.htm
 * http://www.w3.org/2001/XInclude
 * https://www.w3schools.com/xml/xml_namespaces.asp
 * https://cs.au.dk/~amoeller/XML/common/xinclude.html
 * https://www.w3schools.com/graphics/svg_text.asp
 * https://www.w3resource.com/xml/parameter-entities.php
 * https://www.tutorialspoint.com/dtd/dtd_entities.htm
 * https://www.w3schools.com/xml/xml_dtd_intro.asp
 * https://viblo.asia/p/tim-hieu-ve-xml-phan-1-gAm5ybxwKdb
 * https://viblo.asia/p/tim-hieu-ve-xml-phan-2-dtd-vyDZONoxKwj
 * https://scottc130.medium.com/understanding-xxe-vulnerabilities-7e389d3972c2
 * https://airman604.medium.com/from-xxe-to-rce-with-php-expect-the-missing-link-a18c265ea4c7
 * https://github.com/GNOME/yelp/blob/master/data/dtd/docbookx.dtd
 * Tóm tắt về xml dtd khá hay [link youtube mình kham thảo](https://www.youtube.com/watch?v=OjwV5X1Ugvs)
 * ![image](https://user-images.githubusercontent.com/20487674/127424751-7b70b9cf-d94f-439c-9c65-3b446e4094de.png)
