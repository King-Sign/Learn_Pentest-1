![Capture](https://user-images.githubusercontent.com/20487674/138108352-5a29a729-b4cd-4fe4-aaec-8787b4c29001.PNG)
* Phát hiên dấu hiệu LFI và php 7.4.23 không xài được null byte
* ![detect lfi vs php](https://user-images.githubusercontent.com/20487674/138108427-ee2b32ee-72bd-4cc3-9eb9-99628aa4790e.png)
* ![Nối chuỗi  php](https://user-images.githubusercontent.com/20487674/138108509-2f738d5c-f59c-4469-8f55-bccb489a17da.PNG)
* Recon
* ![recon](https://user-images.githubusercontent.com/20487674/138108673-aea48fa7-37f5-4003-b7df-1d7276648fd9.PNG)
* Sử dụng Wrapper php://filter
* ![php_filter](https://user-images.githubusercontent.com/20487674/138111376-d8272593-5582-4c84-a392-1e8ae1bec17a.PNG)
* Source code index.php
* ![source_index php](https://user-images.githubusercontent.com/20487674/138108936-258e966f-37d6-483d-be3d-6879e447be3c.PNG)
* upload.php , thấy blacklist chặn khá nhiều , và tên file sau khi upload cũng chỉnh sửa lại, nên không bypass bằng .htaccess được
* ![source_upload php](https://user-images.githubusercontent.com/20487674/138108995-f93275e7-2f1e-488b-8938-fac53bd04e31.PNG)
* download.php
* ![source_download php](https://user-images.githubusercontent.com/20487674/138109060-888e2510-6774-4bd0-99fb-47bf0ff667c1.PNG)
* Bắt để bypass thì tạo con shell.php xong rùi nén lại thành file.zip
* ![tao_shell](https://user-images.githubusercontent.com/20487674/138109607-460cea8f-c5cb-4786-9702-ac78eb8ea731.PNG)
* ![nén_shell_thanh_zip](https://user-images.githubusercontent.com/20487674/138109622-b0771874-de25-4f97-b022-2b274b53946f.PNG)
* Up file zip chứa shell lên
* ![upfile](https://user-images.githubusercontent.com/20487674/138109762-289e49c6-936b-4246-b97e-4ff54109a07d.PNG)
* Sau đó tìm đường dẫn lấy chứa file , mình focus đoạn trong file download.php, để lấy được dẫn mình cần shareable key và password lúc mình upload file
* ![path](https://user-images.githubusercontent.com/20487674/138110026-10072561-122c-4117-b23c-8bc3823599e7.PNG)
* Sau đó mình lợi dụng LFI sử dụng Wrapper zip:// giải nén file.zip ra: zip://path/1.zip%231.php
* ![giai_nen_zip](https://user-images.githubusercontent.com/20487674/138110754-2dea5aa8-f883-4f9f-9902-40e97011f22c.PNG)
* Wrapper zip:// chưa được cấu hình , nên sử dụng Wrapper phar://
* phar://path/file.zip/1&0=command
* ![giai_nen_phar](https://user-images.githubusercontent.com/20487674/138110971-df0a95e3-f687-4a5a-8446-96d33ccdf3da.png)
* ```Flag: flag{ph4r_d3s3r14l1z4t10n_f0r_th3_w1n}```
