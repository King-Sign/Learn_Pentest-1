Bắt đầu với bài này thì có một số thông tin như sao: SIGNED COOKIE FLASK
![image](https://user-images.githubusercontent.com/20487674/131738488-d6f1215f-c376-4674-aacf-e6d9bf267274.png)
Thử fuzz chỗ login xem thế nào, do bài này có gợi ý flask nên test ssti xem sao
![image](https://user-images.githubusercontent.com/20487674/131738919-468f6771-6c91-4484-8e99-e52ffc3a186b.png)
![image](https://user-images.githubusercontent.com/20487674/131738723-fd181dcd-8476-4274-a7b9-a93572ad55fd.png)

Đùa nhau ak :v 
![image](https://user-images.githubusercontent.com/20487674/131738758-4cadfcdc-4f2e-45ad-a350-96b7f0b0351b.png)
Mình do đề bài có nhắc đến cookie , nên mình xem thử

![image](https://user-images.githubusercontent.com/20487674/131739181-acb75914-0b63-48d0-90b2-d96bae6fea07.png)

Hồi đó mình cũng có nghiên cứu sơ sơ jwt cookie thì thường ở trường đầu tiên  và thứ 2 có thể mã hóa base64 nhưng vẫn có thể không phải jwt , mình cứ thử decode xem sao

![image](https://user-images.githubusercontent.com/20487674/131739538-5243e92a-f04f-4953-b584-822e39c16ee3.png)

Giờ mình thử chuyển isHacked trở thành true xong đem base64 , rùi nối với 2 trường còn lại 

Cookie bây giờ thành eyJpc0hhY2tlZCI6dHJ1ZX0.YS_gGQ.JPImVTYnDPxxW4EyqStSicI0KaY 
![image](https://user-images.githubusercontent.com/20487674/131740097-cd3f6f1a-1b4d-4447-87b0-2a5e1b3fc663.png)
Bị quay trở về trang login
![image](https://user-images.githubusercontent.com/20487674/131740221-95e09f20-34c0-4aa2-854f-552400b73e75.png)

Sau khi mình google đọc thì flask về cookie có 3 phần
![image](https://user-images.githubusercontent.com/20487674/131740565-bb99d69f-5739-4eb9-8d1a-3fa129d664c7.png)

Session Data: chứa nội dung session và được mã hóa base64
Timestamp: mốc thời gian cho máy chủ biết thời điểm dữ liệu được cập nhật lần cuối cùng
Cryptographic Hash: là chuỗi kết hợp Session Data và Timestamp và secret key sau đó đem mã hóa sha1
Mọi người có sử dụng lib flask-unsign và flask-unsign-wordlist để bruteforce secret key
![image](https://user-images.githubusercontent.com/20487674/131742112-8318c544-42e7-478d-8a33-9b27aa33b05f.png)
![image](https://user-images.githubusercontent.com/20487674/131742384-791a4f49-3760-42cb-96a8-d6913f107a64.png)

Tìm thấy secret key: secret , bắt đầu chế cookie thui
![image](https://user-images.githubusercontent.com/20487674/131742894-5437d24e-3863-47cc-aeea-36a27572d021.png)

Lụm flag

![image](https://user-images.githubusercontent.com/20487674/131743111-234012ed-3486-4113-ac9e-82e7074c79b9.png)

Link kham thảo:

https://blog.paradoxis.nl/defeating-flasks-session-management-65706ba9d3ce
https://book.hacktricks.xyz/pentesting/pentesting-web/flask
